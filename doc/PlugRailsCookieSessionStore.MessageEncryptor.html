    <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.14.5">
    <title>PlugRailsCookieSessionStore.MessageEncryptor – plug_rails_cookie_session_store v0.3.0</title>
    <link rel="stylesheet" href="dist/app-a07cea761b.css" />

      <link rel="canonical" href="https://hexdocs.pm/plug_rails_cookie_session_store/PlugRailsCookieSessionStore.MessageEncryptor.html" />

    <script src="dist/sidebar_items-dd843db623.js"></script>
  </head>
  <body data-type="modules">
    <script>if(localStorage.getItem('night-mode')) document.body.className += ' night-mode';</script>

    <div class="main">
<button class="sidebar-toggle">
  <i class="icon-menu"></i>
</button>
<section class="sidebar">


  <a href="api-reference.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        plug_rails_cookie_session_store
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.3.0
      </h2>
    </div>

  </a>

  <div class="sidebar-search">
    <i class="icon-search"></i>
    <input type="text" class="sidebar-searchInput" placeholder="search" autocomplete="off" />
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>


      <li><a id="modules-list" href="#full-list">Modules</a></li>





  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">


      <h1>
        <small class="visible-xs">plug_rails_cookie_session_store v0.3.0</small>
        PlugRailsCookieSessionStore.MessageEncryptor


      </h1>


        <section id="moduledoc">
          <p><code class="inline">MessageEncryptor</code> is a simple way to encrypt values which get stored
somewhere you don’t trust.
The cipher text and initialization vector are base64 encoded and
returned to you.
This can be used in situations similar to the <code class="inline">MessageVerifier</code>, but where
you don’t want users to be able to determine the value of the payload.</p>
<h2 id="module-example" class="section-heading">
  <a href="#module-example" class="hover-link"><i class="icon-link"></i></a>
  Example
</h2>

<pre><code class="elixir">secret_key_base = &quot;072d1e0157c008193fe48a670cce031faa4e...&quot;
encrypted_cookie_salt = &quot;encrypted cookie&quot;
encrypted_signed_cookie_salt = &quot;signed encrypted cookie&quot;
secret = KeyGenerator.generate(secret_key_base, encrypted_cookie_salt)
sign_secret = KeyGenerator.generate(secret_key_base, encrypted_signed_cookie_salt)
encryptor = MessageEncryptor.new(secret, sign_secret)
data = %{current_user: %{name: &quot;José&quot;}}
encrypted = MessageEncryptor.encrypt_and_sign(encryptor, data)
decrypted = MessageEncryptor.verify_and_decrypt(encryptor, encrypted)
decrypted.current_user.name # =&gt; &quot;José&quot;</code></pre>

        </section>



        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <i class="icon-link"></i>
            </a>
            Summary
          </h1>



  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
    <div class="summary-row">
  <div class="summary-signature">
    <a href="#encrypt_and_sign/4">encrypt_and_sign(message, secret, sign_secret, cipher \\ :aes_cbc256)</a>
  </div>

    <div class="summary-synopsis"><p>Encrypts and signs a message</p>
</div>

</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#verify_and_decrypt/4">verify_and_decrypt(encrypted, secret, sign_secret, cipher \\ :aes_cbc256)</a>
  </div>

    <div class="summary-synopsis"><p>Decrypts and verifies a message.
We need to verify the message in order to avoid padding attacks.
Reference: http://www.limited-entropy.com/padding-oracle-attacks</p>
</div>

</div>

  </div>






        </section>





        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <i class="icon-link"></i>
            </a>
            Functions
          </h1>
          <div class="detail" id="encrypt_and_sign/4">

    <span id="encrypt_and_sign/3" />

  <div class="detail-header">
    <a href="#encrypt_and_sign/4" class="detail-link" title="Link to this function">
      <i class="icon-link"></i>
    </a>
    <span class="signature">encrypt_and_sign(message, secret, sign_secret, cipher \\ :aes_cbc256)</span>



  </div>
  <section class="docstring">
    <p>Encrypts and signs a message.</p>

  </section>
</div>
<div class="detail" id="verify_and_decrypt/4">

    <span id="verify_and_decrypt/3" />

  <div class="detail-header">
    <a href="#verify_and_decrypt/4" class="detail-link" title="Link to this function">
      <i class="icon-link"></i>
    </a>
    <span class="signature">verify_and_decrypt(encrypted, secret, sign_secret, cipher \\ :aes_cbc256)</span>



  </div>
  <section class="docstring">
    <p>Decrypts and verifies a message.
We need to verify the message in order to avoid padding attacks.
Reference: http://www.limited-entropy.com/padding-oracle-attacks</p>

  </section>
</div>

        </section>





          <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.14.5),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
            </span>
        </p>
        <button class="night-mode-toggle" />
      </footer>
    </div>
  </div>
</section>
</div>
  <script src="dist/app-4aef34ad5f.js"></script>
  </body>
</html>
